!function(v){"use strict";function n(t,s){return this.elements=v(t),this.last=[],this.current=[],this.enableEvents=!0,this.backup=[],this.options=v.extend({},v.fn.tcTabs.defaults,s),0<this.elements.length&&(this.init(),this)}var w=v.epoAPI.util.getStorage("localStorage"),p=window.confirm;n.prototype={constructor:n,set:function(t){this.options=v.extend({},this.options,t),this.init()},addHeaderEvents:function(i,o,e,t,n,l,r,d,c){var s="",h=this;t.off("closetab.tmtabs").on("closetab.tmtabs",function(){var t=v(this),s=i.find(t.data("tab"));t.removeClass("closed open").addClass("closed"),t.find(".tm-arrow").removeClass(h.options.classdown+" "+h.options.classup).addClass(h.options.classdown),h.options.useclasstohide?s.addClass("tm-hide").removeClass("tm-show"):s.hide(),s.removeClass("tm-animated "+h.options.animationclass),v(window).trigger("tc-closetab.tmtabs",{header:t,tab:s})}),t.off("opentab.tmtabs").on("opentab.tmtabs",function(){var t=v(this),s=i.find(t.data("tab"));t.removeClass("closed open").addClass("open"),t.find(".tm-arrow").removeClass(h.options.classdown+" "+h.options.classup).addClass(h.options.classup),h.options.useclasstohide?s.removeClass("tm-hide").addClass("tm-show"):s.show(),s.removeClass("tm-animated "+h.options.animationclass).addClass("tm-animated "+h.options.animationclass),h.current[o]=t.data("tab"),v(window).trigger("tc-opentab.tmtabs",{header:t,tab:h.current[o],table:s}),h.scrollIntoView(i,t,c)}),!0!==h.options.showonhover&&"function"!=typeof h.options.showonhover||(s=" mouseover"),t.off("keydown.tmtabs").on("keydown.tmtabs",function(t){var s,o=v(this);13===t.keyCode&&o.trigger("click.tmtabs"),40===t.keyCode&&(s=o.closest(".tm-box").next().find("."+h.options.header)),(s=38===t.keyCode?o.closest(".tm-box").prev().find("."+h.options.header):s)&&s.length&&(o.trigger("blur"),s.trigger(" focus").trigger("click"),t.preventDefault())}),t.off("click.tmtabs").on("click.tmtabs"+s,function(t){var s=v(this);t.preventDefault(),"mouseover"===t.type&&"function"==typeof h.options.showonhover&&!h.options.showonhover.call()||(h.current[o]===s.data("tab")?v(window).trigger("tc-isopentab.tmtabs",{header:s,tab:h.current[o],table:i.find(h.current[o])}):(h.last[o]&&v(h.last[o]).trigger("closetab.tmtabs"),s.trigger("opentab.tmtabs"),h.last[o]=s,w&&w.setItem("tmadmintab-"+e,s.attr(h.options.dataopenattribute)),v(window).trigger("tc-tmtabs-clicked",{tc:e,options:h.options,header:s,tab:h.current[o],table:i.find(h.current[o])})))}),this.options.deletebutton?(t.append(this.options.deletebuttonhtml),t.find("."+this.options.deleteheader).off("click.tmtabs").on("click.tmtabs",function(t){var s=v(this),o=s.closest(".tm-box"),e=o.find("."+h.options.header),a=i.find("."+e.attr(h.options.dataattribute));t.stopPropagation(),i.find("."+h.options.headers+" ."+h.options.header).length<2||h.options.deleteconfirm&&!p(window.TMEPOGLOBALADMINJS.i18n_builder_delete)||("function"==typeof h.options.beforedeletetab&&h.options.beforedeletetab.call(i,s,a),a.remove(),e.is(".open")&&(o.next().find("."+h.options.header).is(".closed")?o.next().find("."+h.options.header).trigger("click.tmtabs"):o.prev().find("."+h.options.header).is(".closed")&&o.prev().find("."+h.options.header).trigger("click.tmtabs")),o.remove(),h.checkSize(n,l,r,d,c,!0),"function"==typeof h.options.afterdeletetab&&h.options.afterdeletetab.call(i))})):t.find("."+this.options.deleteheader).remove(),this.options.editbutton?(t.append(h.options.editbuttonhtml),t.find("."+h.options.editheader).off("click.tmtabs").on("click.tmtabs",function(t){var s;h.enableEvents&&"function"==typeof h.options.oneditbutton&&(t.stopPropagation(),t=v(this),s=i.find("."+t.closest(".tm-box").find("."+h.options.header).attr(h.options.dataattribute)),h.options.oneditbutton.call(i,t,s))})):t.find("."+this.options.editheader).remove()},initHeader:function(t,s,o,e,a,i,n,l){var r=s.attr("class"),d="."+(t=v(t)).attr(this.options.dataattribute);t.data("tab",d),this.options.useclasstohide?s.find(d).addClass("tm-hide").removeClass("tm-show"):s.find(d).hide(),s.find(d).data("state","closed"),t.is(".open")?(t.removeClass("closed open").addClass("open").data("state","open"),t.find(".tm-arrow").removeClass(this.options.classdown+" "+this.options.classup).addClass(this.options.classup),this.options.useclasstohide?s.find(d).removeClass("tm-hide").addClass("tm-show"):s.find(d).show(),s.find(d).data("state","open"),this.current[o]=d,this.last[o]=t):t.removeClass("closed open").addClass("closed").data("state","closed"),this.addHeaderEvents(s,o,r,t,e,a,i,n,l)},checkSize:function(t,s,o,e,a,i){var n,l=[];s.parents().addBack().not(":visible").each(function(){var t=v(this),s=this.style.display,o=t.css("display"),e=this.style.visibility,a=!1,o={styleDisplay:s,cssDisplay:o,styleVisibility:e,cssVisibility:t.css("visibility"),display:null,visibility:null,element:t};"none"===s&&(this.style.display="",o.display=!0,"none"===t.css("display")&&(this.style.display="block"),a=!0),"hidden"===e&&(this.style.visibility="",o.visibility=!0,"hidden"===t.css("visibility")&&(this.style.visibility="visible"),a=!0),a&&l.push(o)}),n=Math.round(s.outerWidth()),s.is(".has-scroll-arrows")&&(s.removeClass(".has-scroll-arrows"),n=Math.round(t.outerWidth())),i&&((t=s.find("."+this.options.header+".open")).length&&t.removeClass("open"),a.scrollWidth=s[0].scrollWidth,t.length&&t.addClass("open")),a.scrollWidth>n?(e.addClass("scroll-arrow-show"),o.addClass("scroll-arrow-show"),s.addClass("has-scroll-arrows"),a.scrollWidth-n===s.scrollLeft()?e.addClass("scroll-arrow-disabled scroll-arrow-right-disabled"):e.removeClass("scroll-arrow-disabled scroll-arrow-right-disabled"),0===s.scrollLeft()?o.addClass("scroll-arrow-disabled scroll-arrow-left-disabled"):o.removeClass("scroll-arrow-disabled scroll-arrow-left-disabled")):(e.removeClass("scroll-arrow-show"),o.removeClass("scroll-arrow-show"),s[0].scrollLeft=0,s.removeClass("has-scroll-arrows")),l.forEach(function(t){t.display&&(t.element[0].style.display=t.styleDisplay),t.visibility&&(t.element[0].style.visibility=t.styleVisibility)})},scrollIntoView:function(t,s,o){var e=o.scrollPos,t=t.find("."+this.options.headers),a=t.width();t.is(".has-scroll-arrows")&&s&&void 0!==s&&s.position()&&void 0!==s.position()&&(s.position().left<0?(o.scrollPos=Math.max(e+s.position().left+1,0),t.animate({scrollLeft:o.scrollPos+1+"px"},this.options.scrollDuration)):s.position().left+s.outerWidth()>a&&(o.scrollPos=Math.min(e+(s.position().left+s.outerWidth()-a),t[0].scrollWidth-t.outerWidth()),t.animate({scrollLeft:o.scrollPos-1+"px"},this.options.scrollDuration)))},initElement:function(l,r,d,t){var c,h,p,f,s,i,o,m=this,b=l.attr("class"),e=l.find("."+this.options.headers+" ."+this.options.header),n=0,u="",a={};0!==e.length&&((c=l.find("."+this.options.headers)).wrap('<div class="'+this.options.headersWrap+'"></div>'),h=l.find("."+this.options.headersWrap),this.options.scroll&&(h.html('<div class="tc-scroll-left-arrow"></div>'+h.html()+'<div class="tc-scroll-right-arrow"></div>'),e=l.find("."+this.options.headers+" ."+this.options.header),c=l.find("."+this.options.headers),p=l.find(".tc-scroll-left-arrow"),f=l.find(".tc-scroll-right-arrow"),"function"==typeof v.fn.mousewheel&&c.mousewheel(function(t,s){"none"!==f.css("display")&&(this.scrollLeft-=30*s,d.scrollPos=this.scrollLeft,t.preventDefault())}),c.animate({scrollLeft:d.scrollPos+"px"},0),this.checkSize(h,c,p,f,d,!0),v(window).off("resize.tmtabs"+t).on("resize.tmtabs"+t,function(){m.checkSize(h,c,p,f,d,!0)}),l.off("refresh.tmtabs"+t).on("refresh.tmtabs"+t,function(){m.checkSize(h,c,p,f,d,!0)}),v(function(){m.checkSize(h,c,p,f,d,!0)}),f.off("mousedown.tmtabs mouseup.tmtabs mouseleave.tmtabs mouseover.tmtabs mouseout.tmtabs").on("mousedown.tmtabs",function(t){function s(){var t=c.scrollLeft();d.scrollPos=Math.min(t+m.options.scrollDistance,d.scrollWidth-c.outerWidth()),c.animate({scrollLeft:d.scrollPos+"px"},m.options.scrollDuration,function(){m.checkSize(h,c,p,f,d)})}t.stopPropagation(),s(),o=setInterval(function(){s()},m.options.scrollDuration)}).on("mouseup.tmtabs mouseleave.tmtabs",function(){clearInterval(o)}).on("mouseover.tmtabs",function(){v(this).addClass("scroll-arrow-over scroll-arrow-right-over")}).on("mouseout.tmtabs",function(){v(this).removeClass("scroll-arrow-over scroll-arrow-right-over")}),p.off("mousedown.tmtabs mouseup.tmtabs mouseleave.tmtabs mouseover.tmtabs mouseout.tmtabs").on("mousedown.tmtabs",function(t){function s(){var t=c.scrollLeft();d.scrollPos=Math.max(t-m.options.scrollDistance,0),c.animate({scrollLeft:d.scrollPos+"px"},m.options.scrollDuration,function(){m.checkSize(h,c,p,f,d)})}t.stopPropagation(),s(),o=setInterval(function(){s()},m.options.scrollDuration)}).on("mouseup.tmtabs mouseleave.tmtabs",function(){clearInterval(o)}).on("mouseover.tmtabs",function(){v(this).addClass("scroll-arrow-over scroll-arrow-left-over")}).on("mouseout.tmtabs",function(){v(this).removeClass("scroll-arrow-over scroll-arrow-left-over")})),window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,s,o){a[s]=o}),this.last[r]=!1,this.current[r]="",l.data("tm-has-tmtabs",1),e.each(function(t,s){m.initHeader(s,l,r,h,c,p,f,d)}),this.options.sortabletabs&&l.find("."+this.options.headers+":not(.section_elements ."+this.options.headers+",.tm-settings-wrap ."+this.options.headers+",.builder-element-wrap ."+this.options.headers+")").sortable({cursor:"move",items:".tm-box:not(.tm-add-box)",start:function(t,s){var o=l.find("."+s.item.closest(".tm-box").find("."+m.options.header).attr(m.options.dataattribute));n=s.item.index(),u=s.item.find("."+m.options.header).attr(m.options.dataopenattribute),i=v.tmEPOAdmin.find_index(!0,o.find(".bitem").first()),"function"==typeof m.options.beforemovetab&&m.options.beforemovetab.call(this,n,o,i),m.enableEvents=!1},stop:function(t,s){var s=l.find("."+s.item.closest(".tm-box").find("."+m.options.header).attr(m.options.dataattribute)),o=l.find("."+m.options.slide+"."+u),e=l.find("."+m.options.headers+" ."+m.options.header+"["+m.options.dataopenattribute+"='"+u+"']").parent().index(),a=l.find("."+m.options.slide).eq(e);n<e?a.after(o):e<n&&a.before(o),"function"==typeof m.options.aftermovetab&&m.options.aftermovetab.call(this,e,n,s,i),m.enableEvents=!0},cancel:".tm-add-box",forcePlaceholderSize:!0,revert:200,placeholder:"tm-box pl",tolerance:"pointer"}),this.options.addbutton?(h.append(this.options.addbuttonhtml),l.addClass("has-add-button").find("."+this.options.addheader).off("click.tmtabs").on("click.tmtabs",function(t){var s=l.find("."+m.options.headers+" ."+m.options.header),o=s.last(),e=o.attr(m.options.dataattribute),a=l.find("."+e),i=o.tcClone().off("closetab.tmtabs opentab.tmtabs click.tmtabs"),n=a.tcClone().empty(),s=m.options.slide+s.length;t.preventDefault(),i.html('<span class="tab-text">'+(l.find("."+m.options.headers+" ."+m.options.header).length+1)+"</span>").removeClass("closed open").addClass("closed").data("tab","."+s).data("state","closed").attr(m.options.dataattribute,s),n.removeClass(e).addClass(s),m.options.useclasstohide?n.addClass("tm-hide").removeClass(".tm-show"):n.hide(),n.removeClass("tm-animated "+m.options.animationclass),o.closest(".tm-box").after(i),i.wrap('<div class="tm-box"></div>'),m.addHeaderEvents(l,r,b,i,h,c,p,f,d),a.after(n),m.options.scroll&&c.animate({scrollLeft:i.width()+"px"},m.options.scrollDuration,function(){m.checkSize(h,c,p,f,d,!0)}),"function"==typeof m.options.afteraddtab&&m.options.afteraddtab.call(this,i,n)})):h.find("."+this.options.addheader).remove(),"auto"===this.options.selectedtab?(w&&(s=w.getItem("tmadmintab-"+b)),void 0!==a.selected_tab&&(s=a.selected_tab),null==(s=void 0!==a.menu?a.menu:s)&&(s=l.find("."+this.options.header).eq(0).attr(this.options.dataopenattribute)),(l.find("."+this.options.header+"["+this.options.dataopenattribute+'="'+s+'"]').is(":visible")?l.find("."+this.options.header+"["+this.options.dataopenattribute+'="'+s+'"]'):l.find("."+this.options.header).eq(0)).trigger("click.tmtabs")):!1!==this.options.selectedtab&&(s=parseInt(this.options.selectedtab,10),l.find("."+this.options.header+":eq("+s+")").trigger("click.tmtabs")))},init:function(){var a=this;this.elements.each(function(t){var s=v(this),o={},e=s.html();a.backup[t]?s.html(a.backup[t]):a.backup[t]=e,o.scrollPos=0,o.scrollWidth=0,e=s.css("display"),s.show(),a.initElement(s,t,o,v.epoAPI.math.uniqueid("")),s.css("display",e)})}},v.fn.tcTabs=function(t){var s,o,e=v(this),a=e.data("tctabs"),i=v.makeArray(arguments);return i.splice(0,1),o="object"==typeof t?t:{},a||(a=new n(this,o),e.data("tctabs",a)),void 0===(s="string"==typeof t?a[t].apply(a,i):s)?e:s},v.fn.tcTabs.defaults={headers:"tm-tab-headers",headersWrap:"tc-tab-headers-wrap",header:"tab-header",slide:"tc-tab-slide",classdown:"tcfa-angle-down",classup:"tcfa-angle-up",animationclass:"appear",dataattribute:"data-id",dataopenattribute:"data-id",selectedtab:"auto",showonhover:!1,useclasstohide:!0,sortabletabs:!0,addbutton:!1,addheader:"tm-add-tab",addbuttonhtml:'<div class="tm-add-tab"><span class="tmicon tcfa tcfa-plus"></span></div>',afteraddtab:null,beforemovetab:null,aftermovetab:null,deletebutton:!1,deletebuttonhtml:'<div class="tm-del-tab"><span class="tcfa tcfa-times"></span></div>',deleteheader:"tm-del-tab",deleteconfirm:!1,beforedeletetab:null,afterdeletetab:null,editbutton:!1,editbuttonhtml:'<span class="tm-edit-tab"><span class="tcfa tcfa-edit"></span></span>',editheader:"tm-edit-tab",oneditbutton:null,scroll:!0,scrollDistance:300,scrollDuration:300},v.fn.tcTabs.Constructor=n,v.fn.tmtabs=v.fn.tcTabs}(window.jQuery);