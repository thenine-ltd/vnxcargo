!function(m,u){"use strict";function l(t,i){return this.targets=u(t),this.settings=u.extend({},u.fn.tcToolTip.defaults,i),0<this.targets.length&&(this.init(),this)}var n;u(function(){n=m.TMEPOJS||{tm_epo_global_tooltip_max_width:"340px"}}),l.prototype={constructor:l,removeTooltip:function(t,i){var o=this.settings;t.data("is_moving")||(i.removeClass(o.fadin).addClass(o.fadeout),i.animate({opacity:0},o.speed,function(){u(this).remove()}),t.data("tmtip-title")&&void 0===t.data("tm-tip-html")&&!t.attr("data-tm-tooltip-html")&&t.attr("title",t.data("tmtip-title")),u(m).off("scroll.tcToolTip resize.tcToolTip"),o.onetime&&this.destroy())},initTooltip:function(t,i,o){var a,e,l,s,d=this.settings;t&&i&&1===t.length&&1===i.length&&1===t.data("tm-has-tm-tip")&&(1===o&&(a=void 0!==t.data("tm-tip-html")?t.data("tm-tip-html"):t.attr("data-tm-tooltip-html")?t.attr("data-tm-tooltip-html"):t.attr("title"),i.html(a),t.data("is_moving",!0)),i.find("aside").hide(),""===n.tm_epo_global_tooltip_max_width?u(m).width()<=1.2*i.outerWidth()?i.css("max-width",u(m).width()/1.2+"px"):i.css("max-width","340px"):(n.tm_epo_global_tooltip_max_width.isNumeric()&&(n.tm_epo_global_tooltip_max_width=n.tm_epo_global_tooltip_max_width+"px"),i.css("max-width",n.tm_epo_global_tooltip_max_width)),i.find("aside").show(),i.css({left:"",right:"",top:""}),a=u.epoAPI.dom.scroll(),(s=e=t.offset().left+t.outerWidth()/2-i.outerWidth()/2)<0?(e=t.offset().left+t.outerWidth()/2-20,i.addClass("left")):i.removeClass("left"),0<=s&&e+i.outerWidth()>u(m).width()?((e=t.offset().left-i.outerWidth()+t.outerWidth()/2+20)<0&&(e-=10,i.css("max-width","calc("+i.css("max-width")+" - "+Math.abs(e)+"px)"),e=10),i.addClass("right")):i.removeClass("right"),i.css({left:e,right:"auto",top:l}),l=t.offset().top-i.outerHeight()-10,s=t.offset().top-a.top-i.outerHeight()-10,l<0||s<0?(l=t.offset().top+t.outerHeight()+10,i.addClass("top"),i.removeClass("bottom")):(i.removeClass("top"),i.addClass("bottom")),u(m).trigger("tm_tooltip_show"),o?(i.css({left:e,top:l}),t.data("is_moving",!1)):i.css({left:e,top:l}).removeClass(d.fadeout).addClass(d.fadin))},show:function(t){var i,o=this.settings;if(!t.data("is_moving"))return 1===t.data("tm-has-tm-tip")&&(void 0!==t.data("tm-tip-html")?(i=t.data("tm-tip-html"),t.attr("title")&&t.data("tmtip-title",t.attr("title")),t.removeAttr("title")):t.attr("data-tm-tooltip-html")?(i=t.attr("data-tm-tooltip-html"),t.attr("title")&&t.data("tmtip-title",t.attr("title")),t.removeAttr("title")):i=t.attr("title"),void 0!==i&&(u("#tm-tooltip").remove(),o.tipclass?o.tipclass=" "+o.tipclass:o.tipclass="",(o=u('<div id="tm-tooltip" class="tm-tip tm-animated'+o.tipclass+'"></div>')).css("opacity",0).html(i).appendTo("body"),0<(i=o.find("img")).length&&i.on("load",this.initTooltip.bind(this,t,o)),this.initTooltip(t,o),u(m).on("scroll.tcToolTip resize.tcToolTip",this.initTooltip.bind(this,t,o)),t.data("is_moving",!1),t.on("tmmovetooltip",this.initTooltip.bind(this,t,o,1)),t.on("mouseleave.tc tmhidetooltip",this.removeTooltip.bind(this,t,o)),t.closest("label").on("mouseleave.tc tmhidetooltip",this.removeTooltip.bind(this,t,o)),o.on("click",this.removeTooltip.bind(this,t,o)))),!1},destroy:function(){0<this.targets.length&&(this.targets.toArray().forEach(function(t){t=u(t);t.closest("off").on("mouseleave.tc tmhidetooltip"),t.off("tc-tooltip-html-changed tmmovetooltip tmhidetooltip mouseenter.tc mouseleave.tc tmshowtooltip.tc"),t.removeData("tmtip-title"),t.removeData("tm-tip-html")}),this.targets.removeData("tctooltip tm-has-tm-tip is_moving"))},init:function(){var f=this,g=this.settings;0<this.targets.length&&this.targets.toArray().forEach(function(t){var i,o,a,e,l,s,d,m,n,r,h,p,c=u(t),t=g.tip||void 0;void 0===c.data("tm-has-tm-tip")&&(i=c.attr("data-tm-tooltip-swatch"),o=c.attr("data-tm-tooltip-swatch-desc"),a=c.attr("data-tm-tooltip-swatch-lbl-desc"),e=c.attr("data-tm-tooltip-swatch-img"),l=c.attr("data-tm-tooltip-swatch-img-lbl"),s=c.attr("data-tm-tooltip-swatch-img-desc"),d=c.attr("data-tm-tooltip-swatch-img-lbl-desc"),c.data("tm-has-tm-tip",1),r=void 0!==c.attr("data-original")?c.attr("data-original"):void 0!==c.attr("src")?void 0!==c.attr("data-src")?c.attr("data-src"):c.attr("src"):c[0].src,0===(h=0===(h=0===(h=(p=0===(p=0===(p=(p=c.closest(".tmcp-field-wrap")).is(".tc-epo-element-product-holder")?c.closest(".cpf-element"):p).length?c.closest(".cpf-element"):p).length?c.closest(".cpf-section").find(".tc-section-inner-wrap .tm-section-description.tm-description"):p).find(".tm-tip-html")).length?p.find(".checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline"):h).length?p.next(".checkbox-image-label,.checkbox-image-label-inline,.radio-image-label,.radio-image-label-inline,.tm-tip-html"):h).length&&p.is(".tm-description")&&(h=p),h=u(p=h),p="yes"===c.attr("data-tm-hide-label")||void 0===c.attr("data-tm-hide-label")||h.is(".tm-tip-html"),n="",0===(m=(m=c.closest(".tmcp-field-wrap")).find("[data-tm-tooltip-html]")).length?0<(m=c.closest(".tmcp-field-wrap").find(".tc-inline-description")).length&&(n=m.html()):n=m.attr("data-tm-tooltip-html"),void 0===t?(i?t=h.html():o&&""!==n?t="<aside>"+n+"</aside>":!a||""===h.html()&&""===n?e&&""!==r?t='<img src="'+r+'">':!l||""===h.html()&&""===r?!s||""===r&&""===n?!d||""===h.html()&&""===r&&""===n||(t='<img src="'+r+'"><aside>'+h.html()+"</aside><aside>"+n+"</aside>"):t='<img src="'+r+'"><aside>'+n+"</aside>":t='<img src="'+r+'"><aside>'+h.html()+"</aside>":t="<aside>"+h.html()+"</aside><aside>"+n+"</aside>",void 0!==t&&(c.data("tm-tip-html",t),p&&h.hide()),t=c.attr("data-tm-tooltip-html")?c.attr("data-tm-tooltip-html"):c.attr("title")):c.data("tm-tip-html",t),c.on("tc-tooltip-html-changed",function(){c.attr("data-tm-tooltip-html")?c.show():c.hide()}),c.closest("label").on("mouseenter tmshowtooltip",f.show.bind(f,c)),c.on("mouseenter.tc tmshowtooltip.tc",f.show.bind(f,c)),g.trigger&&f.show(c))})}},u.fn.tcToolTip=function(t){var i,o,a=u(this),e="object"==typeof t?t:{};return a.map(function(){return u(this).data("tctooltip")||""}).get().some(function(t){return""===t})&&(o=new l(this,e),a.data("tctooltip",o)),void 0===(i="string"==typeof t?(o=a.data("tctooltip"))[t].apply(o,[]):i)?a:i},u.fn.tcToolTip.defaults={fadin:"fadein",fadeout:"fadeout",speed:1500},u.fn.tcToolTip.instances=[],u.fn.tcToolTip.Constructor=l,u.tcToolTip=function(t,i){var o=!1;return(t=t||u(".tm-tooltip")).map(function(){return u(this).data("tctooltip")||""}).get().some(function(t){return""===t})&&(o=new l(t,i),t.data("tctooltip",o)),o}}(window,window.jQuery);